%Git-rapport
\documentclass[a4paper]{article}

\usepackage[swedish]{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\setcounter{secnumdepth}{4}
\usepackage{titlesec}
\titleformat{\paragraph}
{\normalfont\normalsize\bfseries}{\theparagraph}{1em}{}
\titlespacing*{\paragraph}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}


\begin{document}
\begin{titlepage}
\centering
{\bfseries\huge Projektrapport DAT290}

\vspace{10mm}

{\Large Radiostyrd Bil, Grupp 07}

\vspace{20mm}

{\Large \itshape{Joakim Junttila, Johanna Gudmandsen, Gustav Holst,\\Henrik Klein Moberg, Anders Berggren Sjöblom, \\[1mm] Stanislaw Zwierzchowski, Carl Lundgren}}

\vspace{10mm}

%Vet ej vilket datum som ska stå
{DATUM}


\normalsize{
\begin{table}[b]
\centering
\begin{tabular}{|l|l|l|}  \hline
          & \bf Namn & \bf Datum   \\ \hline \hline
 Granskad & NAMN     & DATUM        \\ \hline
 Godkänd  & NAMN     & DATUM         \\ \hline
  \end{tabular}  
  \end{table}}
\end{titlepage}

\tableofcontents


\newpage
\section{Introduktion}

Radiostyrda bilar kontrollerandes av handkontroller började produceras på mitten av 60-talet~\cite{RCHistory}. Under åren har de både tävlats med samt varit en väletablerad leksak till barn. Trots att den genomgått mindre justeringar har den radiostyrda bilens uppbyggnad i det stora hela förblivit densamma.

\subsection{Syfte}

Syftet med detta projekt är att uppdatera den klassiska radiostyrda bilen med hjälp av ny teknik och följaktligen erhålla en mer modern teknisk produkt.

\subsection{Mål}

Projektet går ut på att ersätta en del av elektroniken i en radiostyrd bil. Sändaren samt mottagaren som finns i handkontrollens respektive bilens elektronik ska bytas ut mot ARM-baserade system. Vidare ska en kontrollapplikation implementeras med hjälp av ett antal avståndsmätare, därefter ska bilen självständigt kunna köra rakt fram i högsta möjliga takt och på ett avstånd av maximalt 1 cm från en vägg bromsa in helt utan att kollidera med väggen. Dessa uppgraderingar ska båda använda sig av Bluetooth. 

\vspace{5mm} \noindent
Sedan implementeras styrning via en telefonapplikation som ska kunna kontrollera bilen genom ett Androidsystem. Även denna uppgradering ska använda sig av Bluetooth.

\subsection{Arbetsmetod}

Utbytet av mottagare samt sändare har skett i två steg. Styrsignalerna har först uppmätts med hjälp av oscilloskop. Resultatet av detta användes i utvecklandet av ett program som själv kunnat generera samma slags signaler genom en ARM-processor kopplad till bilen. Programmet är skrivet i C i utvecklingsmiljön CodeLite.

%Lägg till referens på "motorernas respons på signalerna är..." samt "STMicroelectronics" BYTA TILL SYSTEMÖVERSIKT, LITE AV DENNA
\vspace{5mm} \noindent
Signalerna som ska avläsas och sedan genereras är av typen PWM (Pulse Width Modulation. Med detta menas att det som ska avläsas på oscilloskopet är hur mycket av signalen som är på maxspänning jämfört med en hel period av radiovågorna. Det som möjliggör avläsningen av signalerna samtidigt som det går att se motorernas respons på signalerna är ett kretskort som delar på signalerna. Efter avläsningen replikeras dessa signaler i vår datorenhet, MD407, för att sedan kunna skickas från datorn direkt till mottagaren i bilen varpå bilen ska ge samma respons som med den ursprungliga sändaren. Detta arbete har förenklats med hjälp av kodbibliotek från STMicroelectronics som innehåller funktioner för att initiera PWM-genererande. 

\vspace{5mm} \noindent
Arbetet med mobilapplikationen inleddes genom att studera bilens ultraljudssensor. Trovärdiga källor som beskrev dess användning hittades, och en grundläggande preliminär planering för sensorns användning ritades upp. Sedan inleddes arbetet på en Androidapplikation med Bluetooth-funktionalitet.
Två appar konstruerades separat; en GUI med olika reglage för att styra hastighet och riktning, och en applikation som kontrollerar Bluetooth. Dessa skrevs i Java genom Eclipse och importerades till Android Studio.

\vspace{5mm} \noindent
Mestadels av arbetet har utförts i designerade laborationssalar. Tillgång till ett skåp med elektroniskt kodlås för förvaring av material har funnits, vilket också varit tillgängligt för samtliga i projektledningen.

\section{Teknisk beskrivning}

\subsection{Teknisk bakgrund}
För att kunna kontrollera en radiobil används en sändare och en mottagare~\cite{RCTechnique}. Radiosignaler på en okänd frekvens skickas från sändaren, handkontrollen, och avkodas av mottagaren, signalomvandlaren, i radiobilen. Dessa omvandlas då till elektroniska signaler som antingen kontrollerar bilens hastighet eller riktning. Parallellt med detta styrs även bilens hastighet av motorns kraftutslag, medan riktningen även beror på hjulens gradförskjutning. Genom en ytterligare signal kan bilens hastighet även reverseras. Bilens styrenhet omvandlar radiosignaler som sedan kontrollerar bilens rörelse.

\subsubsection{Nya styrsignaler}
Bilens styrsignaler kontrolleras av en kontrollenhet, MRX-242. Enheten fungerar simultant som radiomottagare och styrsignalgenerator, och generar signaler till båda motorerna i bilen via tre kablar. I mening att ersätta dessa med nya signaler finns även tillgång till ett ytterligare kopplingsblock. Blocket kopplas mellan MRX-242 och motorerna, och kommer initialt konfigureras att mäta signalerna från den ursprungliga kontrollenheten i bilen. När dessa är kända kommer blocket omkopplas för att generera nya anpassade styrsignaler~\cite{projektDir}. 


\subsection{Systemöversikt}
Systemet har två huvuddelar, Androidapplikationen som agerar handkontroll och bildatorn som genererar signaler till motorerna.



\subsection{Delsystem}
\subsubsection{Androidapplikation}
Androidapplikationen agerar som handkontroll. Av denna krävs endast att skicka bytes seriellt till bilens dator med en Bluetooth-länk för att få trådlöshet. Detta följer protokoll som bestämts av projektledningen där de två mest signifikanta bitarna i varje byte bestämmer vilken sorts signal som ska ändras, till exempel styrning, drivmotor eller initiera kontrollapplikationen. Mobilapplikationen har på skärmen virtuella reglage som ska emulera ordinarie handkontrollens analoga funktion så att exempelvis hastighetsövergången är så jämn som möjligt. 

\subsubsection{Bildator}
Signalerna som skickas från Androidapplikationen tas emot av en generisk Bluetooth-modul som är kopplad till en USART-port på bildatorn. När programmet på denna dator startas måste datorn först skicka PWM-signaler som motsvarar neutralt läge för drivmotorn i en kort stund innan andra signaler kan skickas. Bildatorn tar emot ett kommando från Bluetoothlänken och analyserar detta i mening att ta reda på vilket kommando de två kommandobitarna syftar på ska utföras. PWM-signalerna ändras sedan efter värdet på kommandot, de sex minst signifikanta bitarna, eller påbörjar kontrollapplikationen för demonstration. Motorerna tar emot PWM-signalerna och ger utslag beroende på deras medelspänning.

\subsubsection{PWM-signaler}
PWM eller Pulse Width Modulation är en moduleringsteknik och används mest för att styra mängden elektrisk ström som förs till, exempelvis, en motor. I varje period i en PWM-signal kan spänningen antingen vara 0, låg, eller 1, hög, och det som mottagaren svarar på är hur stor del av perioden som signalen var på högspänning. I detta projekt är maxspänningen ca 3, 4V, och motorerna svarar på en medelspänning mellan 250-450mV. Alltså är perioden på högspänning ungefär 8-12\% av tiden. Dessa medelvärden, eller dutycycles, styrs i bildatorn med hjälp av en av datorns timers och standardbibliotek för dessa



\section{Resultat}




\section{Slutsats}



\newpage
%To references 
\bibliographystyle{IEEEtran}
\bibliography{referenserRapport}


\end{document}